---
title: inclass-week1
author: Ziyang Ye
format:
    html:
        code-fold: true
        embed-resources: true
        self-contained: true
        theme:
            light: [cosmo, theme.scss]
            dark: [cosmo, theme-dark.scss]
        toc: true
---

### Introduction

My name: Ziyang Ye

------------------------------------------------------------------------

My educational background:

Phd - Statistics ---- George Mason University

MS - Data Science ---- Georgetown University

BS - Financial Data Analytics ---- Zhejiang University of Finance & Economics

------------------------------------------------------------------------

My experience:

I have finished several project related with machine learning models. Welcome to click the link of my project below.Here are some of them:

<https://colab.research.google.com/drive/1h_UmqQ6z0HPkLHa-FQo2D4py7bY_QmsL?usp=sharing>

<https://github.com/ZiyangYe566842/ANLY580-Final-Project-Music-Creation-Classification-Transformation>

Project for data visualization. Every plot on this website is interactive, allowing users to click or drag elements for a more engaging experience:

<https://zy236.georgetown.domains/spring2023-project-team-12/website/Final%20Submission/index.html>

As for basic machine learning models:

<https://ziyangye.georgetown.domains/501-project-website/index.html>

------------------------------------------------------------------------

I am quite familiar with python. Then, R and Matlab.

------------------------------------------------------------------------

I have a strong background in coding with python and am actively working to strengthen my mathematics foundation. I am particularly interested in machine learning & deep learning and have gained valuable project experience in this field. My passion for machine learning drives me to continuously enhance my skills and contribute effectively to related projects.

+:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ## Objective Function                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| The Ordinary Least Squares (OLS) objective is:                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  S(\beta) \;=\; \sum_{i=1}^n \bigl(y_i - x_i^\top \beta\bigr)^2                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| or in matrix form:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  S(\beta) \;=\; (y - X\,\beta)^\top \,(y - X\,\beta).                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ## Minimizer of the LS Objective                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Setting the gradient of $\beta$ to zero yields the normal equations:                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  X^\top X \,\hat{\beta}_{\mathrm{OLS}} = X^\top y.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| If (X\^\top X) is invertible:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  \hat{\beta}_{\mathrm{OLS}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|  =                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  \bigl(X^\top X\bigr)^{-1} X^\top y.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ## Exact and Asymptotic Sampling Distributions                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ### Exact Sampling Distribution (Finite Sample)                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Under classical assumptions, including normal errors $\varepsilon_i \sim N(0,\sigma^2)$, we have:                                                                                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  \hat{\beta}_{\mathrm{OLS}} \sim N\Bigl(\beta,\;\sigma^2\,(X^\top X)^{-1}\Bigr).                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ### Asymptotic Sampling Distribution                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| If errors are i.i.d. with mean zero and finite variance (not necessarily normal), then by the Central Limit Theorem:                                                                                                                                                                                                                                                                                                                                                                                                 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  \sqrt{n}\,\bigl(\hat{\beta}_{\mathrm{OLS}} - \beta\bigr)                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|  \xrightarrow{d}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|  N\Bigl(0,\;\sigma^2\,[\mathbb{E}(x_i\,x_i^\top)]^{-1}\Bigr).                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| In practice (large (n)), this is often approximated by:                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  \hat{\beta}_{\mathrm{OLS}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|  \approx                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|  N\bigl(\beta,\;\sigma^2\,(X^\top X)^{-1}\bigr).                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ### Robustness to Minor Deviations                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| \- **Normality**: Exact normality is required for small-sample inference (exact (t)-tests), but in large samples OLS is typically robust due to the CLT. - **Homoskedasticity**: If errors are not homoskedastic, use robust (sandwich) standard errors. - **Independence**: If errors are correlated (e.g., time-series data), specialized methods must account for that.                                                                                                                                           |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ### Assumptions for Exact Distribution                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| The *exact* (finite-sample) distribution of the OLS estimator $\hat{\beta}_{\text{OLS}}$ being normal requires the following standard assumptions:                                                                                                                                                                                                                                                                                                                                                                   |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1\. **Linearity**: The model is linear in (\beta). 2. **Independent and Identically Distributed (i.i.d.) Errors**: $\varepsilon_i \overset{\text{i.i.d.}}{\sim} F$. 3. **Mean Zero**: $\mathbb{E}[\varepsilon_i] = 0$. 4. **Homoskedasticity**: $\text{Var}(\varepsilon_i) = \sigma^2$, a constant (does not depend on $i$). 5. **Normality**: $\varepsilon_i \sim N(0,\sigma^2)$ (Gaussian errors). 6. **No Perfect Multicollinearity**: (X\^\top X) is invertible (i.e., columns of (X) are linearly independent). |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Under these assumptions**, the OLS estimator has the exact sampling distribution:                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  \hat{\beta}_{\mathrm{OLS}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|  \sim                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|  N\bigl(\beta,\; \sigma^2\,(X^\top X)^{-1}\bigr).                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| ### Assumptions for Asymptotic Normality                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| 1\. **Linearity**: Same as above, $y_i = x_i^\top \beta + \varepsilon_i$. 2. **Independent Observations** (or at least weak dependence meeting CLT conditions). 3. **Mean Zero**: $\mathbb{E}[\varepsilon_i \mid x_i] = 0$. 4. **Finite Variance**: $\mathrm{Var}(\varepsilon_i) = \sigma^2 < \infty$. 5. **Regularity Condition on** $X$: Typically,$\frac{1}{n}X^\top X$ converges to a positive-definite matrix as $n \to \infty$. 6. **No Perfect Multicollinearity** (and sufficiently large sample size).      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Under these assumptions (and by the Central Limit Theorem for the sum of random vectors), we get:                                                                                                                                                                                                                                                                                                                                                                                                                    |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  \sqrt{n}\,\bigl(\,\hat{\beta}_{\mathrm{OLS}} - \beta\bigr)                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|  \xrightarrow{d}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|  N\bigl(0,\;\sigma^2\,[\mathbb{E}(x_i\,x_i^\top)]^{-1}\bigr).                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| In practice, people often say:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|  \hat{\beta}_{\mathrm{OLS}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|  \;\approx\;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|  N\Bigl(\beta,\;\sigma^2\,(X^\top X)^{-1}\Bigr),                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|  $$                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| using the observed $X$ in place of $\mathbb{E}(x_i\,x_i^\top)$.                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Overall, **linear regression is fairly robust** to many small-to-moderate deviations from normality, homoskedasticity, etc. However, certain assumption violations (e.g., severe outliers or strong autocorrelation) can still cause significantly biased inferences if left unaddressed. Practitioners often check diagnostic plots, consider robust standard errors, or use specialized models to address more serious violations.                                                                                 |
+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

```{r}
library(tidyverse)

cherry_data <- read_csv("cherry-bloom-dates.csv")
cherry_data
```

```{r}
fit1 <- lm(bloom_doy ~ 0 + location + location:year, data = cherry_data) |> 
  broom::tidy()
fit1
```

```{r}
fit2 <- cherry_data |> 
  group_by(location) |> 
  group_modify(\(x, gr) {
    lm(bloom_doy ~ year, data = x) |> 
      broom::tidy()
  }) |> 
  ungroup()
fit2
```

### Differences in Results

When include `0 + location + location:year` in one model, all locations are fit simultaneously with a single residual variance.

Fitting separate models (one for each location) allows each location to have its own residual variance estimate, which affects standard errors and possibly p-values.

In many cases, the point estimates of slopes/intercepts can be numerically identical between the two approaches (since you have separate intercept and slope per location), but standard errors and test statistics often differ because one model “pools” the error variance while the other does not.

### Dimensions of Covariate Matrices

-   **Single Model (`fit1`)**:\
    If there are $L$ locations and each gets its own intercept and slope, then you have $2L$ parameters.\
    The design matrix $X$ is an $N \times 2L$ matrix, where $N$ is the total number of rows in `cherry_data`.

-   **Separate Models (`fit2`)**:\
    Each location $j$ has $n_j$ observations, so we fit $L$ separate regressions, each with a design matrix of dimension $n_j \times 2$.\
    You do this once per location.

### Which Is Faster?

For modest numbers of locations $L$ and total observations $N$, the speed difference is usually negligible.

-   **Single Model**: Performs one large least-squares solve of size $(2L) \times (2L)$.\
-   **Separate Models**: Performs $L$ small solves of size $(2)\times(2)$ each.

If $L$ is large but each location has few data points, separate models can be faster because each little fit is trivial. If $L$ is small and $N$ is huge, the single model might be more direct. Generally, both are quite fast for typical data sizes.
